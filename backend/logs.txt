[Optimized Route] POST /call-status-optimized - 200 - 1ms
=== OPTIMIZED MAKE CALL REQUEST ===
Timestamp: 2025-08-30T08:45:17.258Z
Request body keys: [
  'to',
  'from',
  'workflowId',
  'nodes',
  'edges',
  'globalPrompt',
  'config',
  'record',
  'timeout',
  'twilioAccountSid',
  'twilioAuthToken'
]
[PredictiveCache] Initialized with config: { maxCacheSize: 10000, maxAge: 86400000, semanticThreshold: 0.85 }
[LanguageOptimizer] Initialized with support for 53 languages
[LanguageOptimizer] Cantonese specialization enabled
[StreamingAudioProcessor] Initialized with config: {
  sampleRate: 8000,
  audioFormat: 'mulaw',
  streamingMode: 'bidirectional',
  optimizations: {
    noiseReduction: true,
    echoCancellation: true,
    voiceActivityDetection: true
  }
}
[StreamingAudioProcessor] Initialized with config: {
  sampleRate: 8000,
  audioFormat: 'mulaw',
  streamingMode: 'bidirectional',
  optimizations: {
    noiseReduction: true,
    echoCancellation: true,
    voiceActivityDetection: true
  }
}
[ConversationRelay] Initialized with bidirectional streaming
[PerformanceOrchestrator] Initialized with all optimizations enabled
[PerformanceOrchestrator] Starting optimized conversation for call call_1756543517258_gmo5ebddf
[ConversationRelay] Starting conversation for call call_1756543517258_gmo5ebddf
[ConversationRelay] Workflow data: {
  workflowId: 'workflow-1756543515468',
  nodesCount: 12,
  edgesCount: 16,
  hasGlobalPrompt: true
}
[ConversationRelay] WebSocket connection setup for call call_1756543517258_gmo5ebddf (using TwiML bridge)
[ConversationRelay] Audio pipeline configured
[ConversationRelay] Stream initialized for call call_1756543517258_gmo5ebddf
[ConversationRelay] Bidirectional streaming setup complete for call call_1756543517258_gmo5ebddf
[ConversationRelay] Conversation started in 0.17734399996697903ms
[PerformanceOrchestrator] Optimized conversation started in 0.2271650000475347ms
Performance optimization initialized: {
  success: true,
  callSid: 'call_1756543517258_gmo5ebddf',
  optimizations: {
    conversationRelay: true,
    predictiveCache: true,
    languageOptimization: true,
    providerFailover: true
  },
  expectedLatency: '150-250ms'
}
Using optimized TwiML endpoint: https://kimiyi-ai.onrender.com/api/twiml-optimized?id=workflow-1756543515468&trackingId=call_1756543517258_gmo5ebddf
Optimized Twilio API call parameters: {
  To: '+919649770017',
  From: '+17077433838',
  Url: 'https://kimiyi-ai.onrender.com/api/twiml-optimized?id=workflow-1756543515468&trackingId=call_1756543517258_gmo5ebddf',
  OptimizationEnabled: true,
  ExpectedLatency: '150-250ms',
  TrackingId: 'call_1756543517258_gmo5ebddf'
}
Twilio call created successfully: {
  callSid: 'CAa2509f67f86b8651a77658eecec2e4da',
  status: 'queued',
  to: '+919649770017',
  from: '+17077433838',
  optimizationEnabled: true,
  trackingId: 'call_1756543517258_gmo5ebddf'
}
[TwiML-Optimized] ===== FAST TWIML REQUEST =====
[TwiML-Optimized] Call: CAa2509f67f86b8651a77658eecec2e4da, Workflow: workflow-1756543515468, Tracking: call_1756543517258_gmo5ebddf
[generateFastTwiML] ===== CREATING TWIML =====
[generateFastTwiML] Workflow: workflow-1756543515468, Tracking: call_1756543517258_gmo5ebddf
[generateFastTwiML] WebSocket URL: wss://kimiyi-ai.onrender.com/api/conversationrelay-ws?workflowId=workflow-1756543515468&trackingId=call_1756543517258_gmo5ebddf
[generateFastTwiML] ===== TWIML GENERATED =====
[generateFastTwiML] TwiML length: 435 chars
[generateFastTwiML] WebSocket URL encoded: wss://kimiyi-ai.onrender.com/api/conversationrelay-ws?workflowId=workflow-1756543515468&amp;trackingId=call_1756543517258_gmo5ebddf
[generateFastTwiML] ACTUAL TWIML CONTENT:
<?xml version="1.0" encoding="UTF-8"?>
<Response>
    <Connect>
        <ConversationRelay
            url="wss://kimiyi-ai.onrender.com/api/conversationrelay-ws?workflowId=workflow-1756543515468&amp;trackingId=call_1756543517258_gmo5ebddf"
            welcomeGreeting="Hello Aditya! I'm your Kimiya. How can I help you today?"
            voice="21m00Tcm4TlvDq8ikWAM"
            language="en-US"
        />
    </Connect>
</Response>
[TwiML-Optimized] FAST TwiML generated in 0.16ms
[TwiML-Optimized] Background orchestrator ready for call_1756543517258_gmo5ebddf
[ConversationRelay-WS] üîç Verifying WebSocket client connection
[ConversationRelay-WS] üîç Origin: undefined
[ConversationRelay-WS] üîç URL: /api/conversationrelay-ws?workflowId=workflow-1756543515468&trackingId=call_1756543517258_gmo5ebddf
[ConversationRelay-WS] üîç User-Agent: Jetty/11.0.20
[ConversationRelay-WS] üîç Sec-WebSocket-Protocol: undefined
[ConversationRelay-WS] ‚úÖ Detected Twilio ConversationRelay connection attempt
[ConversationRelay-WS] üéâ ===== NEW WEBSOCKET CONNECTION ESTABLISHED =====
[ConversationRelay-WS] üîó Request URL: /api/conversationrelay-ws?workflowId=workflow-1756543515468&trackingId=call_1756543517258_gmo5ebddf
[ConversationRelay-WS] üîó Request method: GET
[ConversationRelay-WS] üîó Connection time: 2025-08-30T08:45:24.347Z
[ConversationRelay-WS] üîó Remote address: ::1
[ConversationRelay-WS] üîó User-Agent: Jetty/11.0.20
[ConversationRelay-WS] üîó Protocol: 
[ConversationRelay-WS] ===== CONNECTION PARAMETERS =====
[ConversationRelay-WS] CallSid: call_1756543524347
[ConversationRelay-WS] TrackingId: call_1756543517258_gmo5ebddf
[ConversationRelay-WS] WorkflowId: workflow-1756543515468
[ConversationRelay-WS] All URL params: {
  workflowId: 'workflow-1756543515468',
  trackingId: 'call_1756543517258_gmo5ebddf'
}
[ConversationRelay-WS] ===== REQUEST HEADERS =====
[ConversationRelay-WS] User-Agent: Jetty/11.0.20
[ConversationRelay-WS] Origin: undefined
[ConversationRelay-WS] Protocol: undefined
[ConversationRelay-WS] Host: kimiyi-ai.onrender.com
[ConversationRelay-WS] All headers: {
  host: 'kimiyi-ai.onrender.com',
  'user-agent': 'Jetty/11.0.20',
  'accept-encoding': 'gzip, br',
  'cache-control': 'no-cache',
  'cdn-loop': 'cloudflare; loops=1',
  'cf-connecting-ip': '52.86.15.75',
  'cf-ipcountry': 'US',
  'cf-ray': '977303019f91c488-IAD',
  'cf-visitor': '{"scheme":"https"}',
  connection: 'Upgrade',
  pragma: 'no-cache',
  'render-cf-start-time-msec': '93',
  'render-cf-start-time-sec': '1756543524',
  'render-proxy-ttl': '4',
  'rndr-id': '9ea6a131-2b54-4c15',
  'sec-websocket-key': 'LZ2l3c2yZa433bm8xg+5og==',
  'sec-websocket-version': '13',
  'true-client-ip': '52.86.15.75',
  upgrade: 'websocket',
  'x-forwarded-for': '52.86.15.75, 10.220.242.102',
  'x-forwarded-proto': 'https',
  'x-render-as-num': '14618',
  'x-render-threat-score': '0',
  'x-twilio-signature': '+l6SEd8Ww/Et0oC4FhZfwCLLrfo='
}
[ConversationRelay-WS] üïê Started silence timeout for call_1756543524347 (30000ms)
[ConversationRelay-WS] ‚úÖ ConversationRelay session ready for call_1756543524347 - waiting for setup message
[ConversationRelay-WS] ===== MESSAGE RECEIVED =====
[ConversationRelay-WS] CallSid: call_1756543524347
[ConversationRelay-WS] Event: undefined
[ConversationRelay-WS] Message count: 1
[ConversationRelay-WS] Message size: 353 bytes
[ConversationRelay-WS] Timestamp: 2025-08-30T08:45:24.445Z
[ConversationRelay-WS] Session active: false
[ConversationRelay-WS] Full message structure: [
  'type',             'sessionId',
  'callSid',          'parentCallSid',
  'from',             'to',
  'forwardedFrom',    'callerName',
  'direction',        'callType',
  'callStatus',       'accountSid',
  'customParameters'
]
[ConversationRelay-WS] Message preview: {"type":"setup","sessionId":"VX6c48222fbc79aaa7ab69a654c8bee08f","callSid":"CAa2509f67f86b8651a77658eecec2e4da","parentCallSid":"","from":"+17077433838","to":"+919649770017","forwardedFrom":"","caller...
[ConversationRelay-WS] üîß Handling SETUP message - ConversationRelay initialization
[ConversationRelay-WS] üîß SETUP message received for call_1756543524347
[ConversationRelay-WS] Setup details: {
  "type": "setup",
  "sessionId": "VX6c48222fbc79aaa7ab69a654c8bee08f",
  "callSid": "CAa2509f67f86b8651a77658eecec2e4da",
  "parentCallSid": "",
  "from": "+17077433838",
  "to": "+919649770017",
  "forwardedFrom": "",
  "callerName": "",
  "direction": "outbound-api",
  "callType": "PSTN",
  "callStatus": "IN_PROGRESS",
  "accountSid": "AC64208c7087a03b475ea7fa9337b692f8",
  "customParameters": {}
}
[ConversationRelay-WS] ‚úÖ Setup complete, waiting for user input for call_1756543524347
[ConversationRelay-WS] TwiML welcomeGreeting will handle initial greeting automatically
[ConversationRelay-WS] üí¨ Sending follow-up prompt to encourage user interaction
[ConversationRelay-WS] üì§ Sending text message to call_1756543524347: "How can I help you today?"
[ConversationRelay-WS] üì§ Sending assistant message (official format)
[ConversationRelay-WS] üìã Full message being sent: {
  "type": "assistant",
  "text": "How can I help you today?"
}
[ConversationRelay-WS] üîÑ Attempting to send message via WebSocket
[ConversationRelay-WS] WebSocket state: 1 (1=OPEN, 2=CLOSING, 3=CLOSED)
[ConversationRelay-WS] üì° Sending to Twilio ConversationRelay: {"type":"assistant","text":"How can I help you today?"}
[ConversationRelay-WS] ‚úÖ Message sent successfully to ConversationRelay
[ConversationRelay-WS] ‚úÖ Text message sent successfully to call_1756543524347
[ConversationRelay-WS] ===== MESSAGE RECEIVED =====
[ConversationRelay-WS] CallSid: call_1756543524347
[ConversationRelay-WS] Event: undefined
[ConversationRelay-WS] Message count: 2
[ConversationRelay-WS] Message size: 122 bytes
[ConversationRelay-WS] Timestamp: 2025-08-30T08:45:27.545Z
[ConversationRelay-WS] Session active: true
[ConversationRelay-WS] Full message structure: [ 'type', 'description' ]
[ConversationRelay-WS] Message preview: {"type":"error","description":"Invalid message received: {\"type\":\"assistant\",\"text\":\"How can I help you today?\"}"}...
[ConversationRelay-WS] ‚ùå Handling ERROR message - ConversationRelay error
[ConversationRelay-WS] üì§ Sending text message to call_1756543524347: "I apologize, there was a technical issue. Could you please repeat that?"
[ConversationRelay-WS] üì§ Sending assistant message (official format)
[ConversationRelay-WS] üìã Full message being sent: {
  "type": "assistant",
  "text": "I apologize, there was a technical issue. Could you please repeat that?"
}
[ConversationRelay-WS] üîÑ Attempting to send message via WebSocket
[ConversationRelay-WS] WebSocket state: 1 (1=OPEN, 2=CLOSING, 3=CLOSED)
[ConversationRelay-WS] üì° Sending to Twilio ConversationRelay: {"type":"assistant","text":"I apologize, there was a technical issue. Could you please repeat that?"}
[ConversationRelay-WS] ‚ùå ConversationRelay ERROR for call_1756543524347: {
  type: 'error',
  description: 'Invalid message received: {"type":"assistant","text":"How can I help you today?"}'
}
[ConversationRelay-WS] Error type: unknown
[ConversationRelay-WS] Error message: No message
[ConversationRelay-WS] ‚úÖ Message sent successfully to ConversationRelay
[ConversationRelay-WS] ‚úÖ Text message sent successfully to call_1756543524347
[ConversationRelay-WS] ===== MESSAGE RECEIVED =====
[ConversationRelay-WS] CallSid: call_1756543524347
[ConversationRelay-WS] Event: undefined
[ConversationRelay-WS] Message count: 3
[ConversationRelay-WS] Message size: 168 bytes
[ConversationRelay-WS] ‚ùå ConversationRelay ERROR for call_1756543524347: {
[ConversationRelay-WS] Timestamp: 2025-08-30T08:45:27.643Z
[ConversationRelay-WS] Session active: true
[ConversationRelay-WS] Full message structure: [ 'type', 'description' ]
[ConversationRelay-WS] Message preview: {"type":"error","description":"Invalid message received: {\"type\":\"assistant\",\"text\":\"I apologize, there was a technical issue. Could you please repeat that?\"}"}...
[ConversationRelay-WS] ‚ùå Handling ERROR message - ConversationRelay error
[ConversationRelay-WS] üì§ Sending text message to call_1756543524347: "I apologize, there was a technical issue. Could you please repeat that?"
[ConversationRelay-WS] üì§ Sending assistant message (official format)
[ConversationRelay-WS] üìã Full message being sent: {
  "type": "assistant",
  type: 'error',
  description: 'Invalid message received: {"type":"assistant","text":"I apologize, there was a technical issue. Could you please repeat that?"}'
}
[ConversationRelay-WS] Error type: unknown
[ConversationRelay-WS] Error message: No message
  "text": "I apologize, there was a technical issue. Could you please repeat that?"
}
[ConversationRelay-WS] üîÑ Attempting to send message via WebSocket
[ConversationRelay-WS] WebSocket state: 1 (1=OPEN, 2=CLOSING, 3=CLOSED)
[ConversationRelay-WS] üì° Sending to Twilio ConversationRelay: {"type":"assistant","text":"I apologize, there was a technical issue. Could you please repeat that?"}
[ConversationRelay-WS] ‚úÖ Message sent successfully to ConversationRelay
[ConversationRelay-WS] ‚úÖ Text message sent successfully to call_1756543524347
[ConversationRelay-WS] ===== MESSAGE RECEIVED =====
[ConversationRelay-WS] CallSid: call_1756543524347
[ConversationRelay-WS] Event: undefined
[ConversationRelay-WS] Message count: 4
[ConversationRelay-WS] Message size: 168 bytes
[ConversationRelay-WS] Timestamp: 2025-08-30T08:45:27.746Z
[ConversationRelay-WS] Session active: true
[ConversationRelay-WS] Full message structure: [ 'type', 'description' ]
[ConversationRelay-WS] ‚ùå ConversationRelay ERROR for call_1756543524347: {
  type: 'error',
  description: 'Invalid message received: {"type":"assistant","text":"I apologize, there was a technical issue. Could you please repeat that?"}'
}
[ConversationRelay-WS] Error type: unknown
[ConversationRelay-WS] Error message: No message
[ConversationRelay-WS] Message preview: {"type":"error","description":"Invalid message received: {\"type\":\"assistant\",\"text\":\"I apologize, there was a technical issue. Could you please repeat that?\"}"}...
[ConversationRelay-WS] ‚ùå Handling ERROR message - ConversationRelay error
[ConversationRelay-WS] üì§ Sending text message to call_1756543524347: "I apologize, there was a technical issue. Could you please repeat that?"
[ConversationRelay-WS] üì§ Sending assistant message (official format)
[ConversationRelay-WS] üìã Full message being sent: {
  "type": "assistant",
  "text": "I apologize, there was a technical issue. Could you please repeat that?"
}
[ConversationRelay-WS] üîÑ Attempting to send message via WebSocket
[ConversationRelay-WS] WebSocket state: 1 (1=OPEN, 2=CLOSING, 3=CLOSED)
[ConversationRelay-WS] üì° Sending to Twilio ConversationRelay: {"type":"assistant","text":"I apologize, there was a technical issue. Could you please repeat that?"}
[ConversationRelay-WS] ‚úÖ Message sent successfully to ConversationRelay
[ConversationRelay-WS] ‚úÖ Text message sent successfully to call_1756543524347
[ConversationRelay-WS] ===== MESSAGE RECEIVED =====
[ConversationRelay-WS] CallSid: call_1756543524347
[ConversationRelay-WS] ‚ùå ConversationRelay ERROR for call_1756543524347: {
[ConversationRelay-WS] Event: undefined
[ConversationRelay-WS] Message count: 5
[ConversationRelay-WS] Message size: 168 bytes
[ConversationRelay-WS] Timestamp: 2025-08-30T08:45:27.844Z
[ConversationRelay-WS] Session active: true
[ConversationRelay-WS] Full message structure: [ 'type', 'description' ]
[ConversationRelay-WS] Message preview: {"type":"error","description":"Invalid message received: {\"type\":\"assistant\",\"text\":\"I apologize, there was a technical issue. Could you please repeat that?\"}"}...
[ConversationRelay-WS] ‚ùå Handling ERROR message - ConversationRelay error
[ConversationRelay-WS] üì§ Sending text message to call_1756543524347: "I apologize, there was a technical issue. Could you please repeat that?"
  type: 'error',
  description: 'Invalid message received: {"type":"assistant","text":"I apologize, there was a technical issue. Could you please repeat that?"}'
}
[ConversationRelay-WS] Error type: unknown
[ConversationRelay-WS] Error message: No message
[ConversationRelay-WS] üì§ Sending assistant message (official format)
[ConversationRelay-WS] üìã Full message being sent: {
  "type": "assistant",
  "text": "I apologize, there was a technical issue. Could you please repeat that?"
}
[ConversationRelay-WS] üîÑ Attempting to send message via WebSocket
[ConversationRelay-WS] WebSocket state: 1 (1=OPEN, 2=CLOSING, 3=CLOSED)
[ConversationRelay-WS] üì° Sending to Twilio ConversationRelay: {"type":"assistant","text":"I apologize, there was a technical issue. Could you please repeat that?"}
[ConversationRelay-WS] ‚úÖ Message sent successfully to ConversationRelay
[ConversationRelay-WS] ‚úÖ Text message sent successfully to call_1756543524347
[ConversationRelay-WS] ===== MESSAGE RECEIVED =====
[ConversationRelay-WS] CallSid: call_1756543524347
[ConversationRelay-WS] Event: undefined
[ConversationRelay-WS] Message count: 6
[ConversationRelay-WS] Message size: 168 bytes
[ConversationRelay-WS] Timestamp: 2025-08-30T08:45:27.942Z
[ConversationRelay-WS] Session active: true
[ConversationRelay-WS] Full message structure: [ 'type', 'description' ]
[ConversationRelay-WS] Message preview: {"type":"error","description":"Invalid message received: {\"type\":\"assistant\",\"text\":\"I apologize, there was a technical issue. Could you please repeat that?\"}"}...
[ConversationRelay-WS] ‚ùå Handling ERROR message - ConversationRelay error
[ConversationRelay-WS] ‚ùå ConversationRelay ERROR for call_1756543524347: {
  type: 'error',
  description: 'Invalid message received: {"type":"assistant","text":"I apologize, there was a technical issue. Could you please repeat that?"}'
}
[ConversationRelay-WS] Error type: unknown
[ConversationRelay-WS] Error message: No message
[ConversationRelay-WS] üì§ Sending text message to call_1756543524347: "I apologize, there was a technical issue. Could you please repeat that?"
[ConversationRelay-WS] üì§ Sending assistant message (official format)
[ConversationRelay-WS] üìã Full message being sent: {
  "type": "assistant",
  "text": "I apologize, there was a technical issue. Could you please repeat that?"
}
[ConversationRelay-WS] üîÑ Attempting to send message via WebSocket
[ConversationRelay-WS] WebSocket state: 1 (1=OPEN, 2=CLOSING, 3=CLOSED)
[ConversationRelay-WS] üì° Sending to Twilio ConversationRelay: {"type":"assistant","text":"I apologize, there was a technical issue. Could you please repeat that?"}
[ConversationRelay-WS] ‚úÖ Message sent successfully to ConversationRelay
[ConversationRelay-WS] ‚úÖ Text message sent successfully to call_1756543524347
[ConversationRelay-WS] ===== MESSAGE RECEIVED =====
[ConversationRelay-WS] CallSid: call_1756543524347
[ConversationRelay-WS] Event: undefined
[ConversationRelay-WS] Message count: 7
[ConversationRelay-WS] Message size: 168 bytes
[ConversationRelay-WS] Timestamp: 2025-08-30T08:45:28.040Z
[ConversationRelay-WS] Session active: true
[ConversationRelay-WS] Full message structure: [ 'type', 'description' ]
[ConversationRelay-WS] Message preview: {"type":"error","description":"Invalid message received: {\"type\":\"assistant\",\"text\":\"I apologize, there was a technical issue. Could you please repeat that?\"}"}...
[ConversationRelay-WS] ‚ùå Handling ERROR message - ConversationRelay error
[ConversationRelay-WS] ‚ùå ConversationRelay ERROR for call_1756543524347: {
  type: 'error',
  description: 'Invalid message received: {"type":"assistant","text":"I apologize, there was a technical issue. Could you please repeat that?"}'
}
[ConversationRelay-WS] üì§ Sending text message to call_1756543524347: "I apologize, there was a technical issue. Could you please repeat that?"
[ConversationRelay-WS] üì§ Sending assistant message (official format)
[ConversationRelay-WS] Error type: unknown
[ConversationRelay-WS] Error message: No message
[ConversationRelay-WS] üìã Full message being sent: {
  "type": "assistant",
  "text": "I apologize, there was a technical issue. Could you please repeat that?"
}
[ConversationRelay-WS] üîÑ Attempting to send message via WebSocket
[ConversationRelay-WS] WebSocket state: 1 (1=OPEN, 2=CLOSING, 3=CLOSED)
[ConversationRelay-WS] üì° Sending to Twilio ConversationRelay: {"type":"assistant","text":"I apologize, there was a technical issue. Could you please repeat that?"}
[ConversationRelay-WS] ‚úÖ Message sent successfully to ConversationRelay
[ConversationRelay-WS] ‚úÖ Text message sent successfully to call_1756543524347
[ConversationRelay-WS] ===== MESSAGE RECEIVED =====
[ConversationRelay-WS] CallSid: call_1756543524347
[ConversationRelay-WS] Event: undefined
[ConversationRelay-WS] Message count: 8
[ConversationRelay-WS] Message size: 168 bytes
[ConversationRelay-WS] Timestamp: 2025-08-30T08:45:28.139Z
[ConversationRelay-WS] Session active: true
[ConversationRelay-WS] Full message structure: [ 'type', 'description' ]
[ConversationRelay-WS] Message preview: {"type":"error","description":"Invalid message received: {\"type\":\"assistant\",\"text\":\"I apologize, there was a technical issue. Could you please repeat that?\"}"}...
[ConversationRelay-WS] ‚ùå Handling ERROR message - ConversationRelay error
[ConversationRelay-WS] üì§ Sending text message to call_1756543524347: "I apologize, there was a technical issue. Could you please repeat that?"
[ConversationRelay-WS] üì§ Sending assistant message (official format)
[ConversationRelay-WS] ‚ùå ConversationRelay ERROR for call_1756543524347: {
[ConversationRelay-WS] üìã Full message being sent: {
  type: 'error',
  description: 'Invalid message received: {"type":"assistant","text":"I apologize, there was a technical issue. Could you please repeat that?"}'
}
[ConversationRelay-WS] Error type: unknown
[ConversationRelay-WS] Error message: No message
  "type": "assistant",
  "text": "I apologize, there was a technical issue. Could you please repeat that?"
}
[ConversationRelay-WS] üîÑ Attempting to send message via WebSocket
[ConversationRelay-WS] WebSocket state: 1 (1=OPEN, 2=CLOSING, 3=CLOSED)
[ConversationRelay-WS] üì° Sending to Twilio ConversationRelay: {"type":"assistant","text":"I apologize, there was a technical issue. Could you please repeat that?"}
[ConversationRelay-WS] ‚úÖ Message sent successfully to ConversationRelay
[ConversationRelay-WS] ‚úÖ Text message sent successfully to call_1756543524347
[ConversationRelay-WS] ‚ùå ConversationRelay ERROR for call_1756543524347: {
  type: 'error',
  description: 'Invalid message received: {"type":"assistant","text":"I apologize, there was a technical issue. Could you please repeat that?"}'
}
[ConversationRelay-WS] Error type: unknown
[ConversationRelay-WS] Error message: No message
[ConversationRelay-WS] ===== MESSAGE RECEIVED =====
[ConversationRelay-WS] CallSid: call_1756543524347
[ConversationRelay-WS] Event: undefined
[ConversationRelay-WS] Message count: 9
[ConversationRelay-WS] Message size: 168 bytes
[ConversationRelay-WS] Timestamp: 2025-08-30T08:45:28.237Z
[ConversationRelay-WS] Session active: true
[ConversationRelay-WS] Full message structure: [ 'type', 'description' ]
[ConversationRelay-WS] Message preview: {"type":"error","description":"Invalid message received: {\"type\":\"assistant\",\"text\":\"I apologize, there was a technical issue. Could you please repeat that?\"}"}...
[ConversationRelay-WS] ‚ùå Handling ERROR message - ConversationRelay error
[ConversationRelay-WS] üì§ Sending text message to call_1756543524347: "I apologize, there was a technical issue. Could you please repeat that?"
[ConversationRelay-WS] üì§ Sending assistant message (official format)
[ConversationRelay-WS] üìã Full message being sent: {
  "type": "assistant",
  "text": "I apologize, there was a technical issue. Could you please repeat that?"
}
[ConversationRelay-WS] üîÑ Attempting to send message via WebSocket
[ConversationRelay-WS] WebSocket state: 1 (1=OPEN, 2=CLOSING, 3=CLOSED)
[ConversationRelay-WS] üì° Sending to Twilio ConversationRelay: {"type":"assistant","text":"I apologize, there was a technical issue. Could you please repeat that?"}
[ConversationRelay-WS] ‚úÖ Message sent successfully to ConversationRelay
[ConversationRelay-WS] ‚úÖ Text message sent successfully to call_1756543524347
[ConversationRelay-WS] ===== MESSAGE RECEIVED =====
[ConversationRelay-WS] CallSid: call_1756543524347
[ConversationRelay-WS] Event: undefined
[ConversationRelay-WS] Message count: 10
[ConversationRelay-WS] Message size: 168 bytes
[ConversationRelay-WS] Timestamp: 2025-08-30T08:45:28.335Z
[ConversationRelay-WS] Session active: true
[ConversationRelay-WS] Full message structure: [ 'type', 'description' ]
[ConversationRelay-WS] Message preview: {"type":"error","description":"Invalid message received: {\"type\":\"assistant\",\"text\":\"I apologize, there was a technical issue. Could you please repeat that?\"}"}...
[ConversationRelay-WS] ‚ùå Handling ERROR message - ConversationRelay error
[ConversationRelay-WS] üì§ Sending text message to call_1756543524347: "I apologize, there was a technical issue. Could you please repeat that?"
[ConversationRelay-WS] üì§ Sending assistant message (official format)
[ConversationRelay-WS] üìã Full message being sent: {
  "type": "assistant",
  "text": "I apologize, there was a technical issue. Could you please repeat that?"
}
[ConversationRelay-WS] üîÑ Attempting to send message via WebSocket
[ConversationRelay-WS] WebSocket state: 1 (1=OPEN, 2=CLOSING, 3=CLOSED)
[ConversationRelay-WS] üì° Sending to Twilio ConversationRelay: {"type":"assistant","text":"I apologize, there was a technical issue. Could you please repeat that?"}
[ConversationRelay-WS] ‚úÖ Message sent successfully to ConversationRelay
[ConversationRelay-WS] ‚úÖ Text message sent successfully to call_1756543524347
[ConversationRelay-WS] ‚ùå ConversationRelay ERROR for call_1756543524347: {
  type: 'error',
  description: 'Invalid message received: {"type":"assistant","text":"I apologize, there was a technical issue. Could you please repeat that?"}'
}
[ConversationRelay-WS] Error type: unknown
[ConversationRelay-WS] Error message: No message
[ConversationRelay-WS] ===== MESSAGE RECEIVED =====
[ConversationRelay-WS] CallSid: call_1756543524347
[ConversationRelay-WS] Event: undefined
[ConversationRelay-WS] Message count: 11
[ConversationRelay-WS] Message size: 168 bytes
[ConversationRelay-WS] Timestamp: 2025-08-30T08:45:28.432Z
[ConversationRelay-WS] Session active: true
[ConversationRelay-WS] Full message structure: [ 'type', 'description' ]
[ConversationRelay-WS] Message preview: {"type":"error","description":"Invalid message received: {\"type\":\"assistant\",\"text\":\"I apologize, there was a technical issue. Could you please repeat that?\"}"}...
[ConversationRelay-WS] ‚ùå Handling ERROR message - ConversationRelay error
[ConversationRelay-WS] ‚ùå ConversationRelay ERROR for call_1756543524347: {
  type: 'error',
  description: 'Invalid message received: {"type":"assistant","text":"I apologize, there was a technical issue. Could you please repeat that?"}'
}
[ConversationRelay-WS] Error type: unknown
[ConversationRelay-WS] Error message: No message
[ConversationRelay-WS] üì§ Sending text message to call_1756543524347: "I apologize, there was a technical issue. Could you please repeat that?"
[ConversationRelay-WS] üì§ Sending assistant message (official format)
[ConversationRelay-WS] üìã Full message being sent: {
  "type": "assistant",
  "text": "I apologize, there was a technical issue. Could you please repeat that?"
}
[ConversationRelay-WS] üîÑ Attempting to send message via WebSocket
[ConversationRelay-WS] WebSocket state: 1 (1=OPEN, 2=CLOSING, 3=CLOSED)
[ConversationRelay-WS] üì° Sending to Twilio ConversationRelay: {"type":"assistant","text":"I apologize, there was a technical issue. Could you please repeat that?"}
[ConversationRelay-WS] ‚úÖ Message sent successfully to ConversationRelay
[ConversationRelay-WS] ‚úÖ Text message sent successfully to call_1756543524347
[ConversationRelay-WS] üîå Connection closed for CallSid=call_1756543524347, Code=1007, Reason=Too many consecutive malformed messages.
[ConversationRelay-WS] Session duration: 4086ms, State: waiting_for_speech
[ConversationRelay-WS] üõë Cleared silence timeout for closed session call_1756543524347
[Call Status Optimized] Call CAa2509f67f86b8651a77658eecec2e4da status: completed, tracking: call_1756543517258_gmo5ebddf
[PerformanceOrchestrator] Failed to stop optimized conversation: Error: No call data found for CAa2509f67f86b8651a77658eecec2e4da
    at PerformanceOrchestrator.stopOptimizedConversation (/opt/render/project/src/backend/services/performanceOrchestrator.js:147:15)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async /opt/render/project/src/backend/routes/optimized-routes.js:50:11
[PerformanceOrchestrator] Stopping optimized conversation for call CAa2509f67f86b8651a77658eecec2e4da
[ConversationRelay] Stopping conversation for call CAa2509f67f86b8651a77658eecec2e4da
[Call Status Optimized] Error cleaning up orchestrator: Error [ERR_UNHANDLED_ERROR]: Unhandled error. ({
  callSid: 'CAa2509f67f86b8651a77658eecec2e4da',
  error: Error: No call data found for CAa2509f67f86b8651a77658eecec2e4da
      at PerformanceOrchestrator.stopOptimizedConversation (/opt/render/project/src/backend/services/performanceOrchestrator.js:147:15)
      at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
      at async /opt/render/project/src/backend/routes/optimized-routes.js:50:11,
  phase: 'cleanup'
})
    at PerformanceOrchestrator.emit (node:events:497:17)
    at PerformanceOrchestrator.stopOptimizedConversation (/opt/render/project/src/backend/services/performanceOrchestrator.js:159:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async /opt/render/project/src/backend/routes/optimized-routes.js:50:11 {
  code: 'ERR_UNHANDLED_ERROR',
  context: {
    callSid: 'CAa2509f67f86b8651a77658eecec2e4da',
    error: Error: No call data found for CAa2509f67f86b8651a77658eecec2e4da
        at PerformanceOrchestrator.stopOptimizedConversation (/opt/render/project/src/backend/services/performanceOrchestrator.js:147:15)
        at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
        at async /opt/render/project/src/backend/routes/optimized-routes.js:50:11,
    phase: 'cleanup'
  }
}